<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="da" class="no-js">
  <head>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KGW3M5J');</script>
<!-- End Google Tag Manager -->

    <meta charset="utf-8">





<title>Struggling with duplicate content in Drupal 7 - larsolesen.dk</title>
<meta name="description" content="I struggled many hours to improve the technical side of SEO on Vejle Idrætshøjskoles website. Here is what I discovered:">


  <meta name="author" content="Lars Olesen">


<meta property="og:type" content="article">
<meta property="og:locale" content="da">
<meta property="og:site_name" content="larsolesen.dk">
<meta property="og:title" content="Struggling with duplicate content in Drupal 7 - larsolesen.dk">
<meta property="og:url" content="https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7">


  <meta property="og:description" content="I struggled many hours to improve the technical side of SEO on Vejle Idrætshøjskoles website. Here is what I discovered:">





  <meta name="twitter:site" content="@lsolesen">
  <meta name="twitter:title" content="Struggling with duplicate content in Drupal 7 - larsolesen.dk">
  <meta name="twitter:description" content="I struggled many hours to improve the technical side of SEO on Vejle Idrætshøjskoles website. Here is what I discovered:">
  <meta name="twitter:url" content="https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2011-12-08T00:00:00+00:00">



  <meta property="article:modified_time" content="2011-12-09T10:21:23+00:00">



  

  


<link rel="canonical" href="https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7" data-proofer-ignore>






<script type="application/ld+json">
  {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "@id": "https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7/#webpage",
      "name": "Struggling with duplicate content in Drupal 7 - larsolesen.dk",
      "url": "https://www.larsolesen.dk",
      "description": "<p>I struggled many hours to improve the technical side of SEO on <a href=\"https://www.vih.dk\">Vejle Idrætshøjskole</a>s website. Here is what I discovered:</p>",
      "isPartOf": { "@type": "WebSite", "@id": "https://www.larsolesen.dk/#website" },
      "datePublished": "2011-12-08 00:00:00 +0000",
      "dateModified": "2011-12-09 10:21:23 +0000",
      
      "inLanguage": "da",
      "potentialAction": [
        { "@type": "ReadAction", "target": ["https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7"] }
      ]
  }
</script>


<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "@id": "https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7/#article",
        "inLanguage": "da",
        "name": "Struggling with duplicate content in Drupal 7",
        "headline": "Struggling with duplicate content in Drupal 7 - larsolesen.dk",
        "keywords": "drupal,planet drupal",
        "description": "<p>I struggled many hours to improve the technical side of SEO on <a href=\"https://www.vih.dk\">Vejle Idrætshøjskole</a>s website. Here is what I discovered:</p>",
        "articleBody": "I struggled many hours to improve the technical side of SEO on Vejle Idrætshøjskoles website. Here is what I discovered:\n\nGoogle Webmaster Tools showed me duplicate content\n\nAfter reviewing Google Webmaster Tools (under Diagnose –&gt; HTML suggestions) I discovered that I had quite a lot of duplicate content, mainly caused by Views adding order- and sort-parameters to the query, thus making Google index basically the same page twice. Allthough, it seems that Google doesn’t think webmasters should make special measures anymore, I do not like having my pages indexed twice.\n\nThere is also a discussion at drupal.org which addresses the problem about duplicate content, as I discovered.\n\nBlocking duplicate links in robots.txt\n\nTo avoid the links introduced by views being indexed by Google, I entered the following in my robots.txt.\n\nDisallow: /*sort=\nDisallow: /*order=\nDisallow: /*page=1\n\nIn a week or so, I hope that I will be rid of all the duplicate content created by the extra parameters views adds to the links.\n\nViews should not default to base view\n\nHaving setup a Views page on e.g. example.com/nyheder will automatically make requests like example.com/nyheder/34 show the base view url. To avoid this, you need to setup contextual filters on your views. I just leave everything to the basic settings, except I will add a validation rule. If the validation does not pass, I will show a 404. That, I hope, basically solved my biggest problem with duplicate content. And hopefully whis will make Google very happy and will award me some SEO LOVE.\n\nWhat are you doing to avoid duplicate content?\n",
        "image": [
            
        ],
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7"
        },
        "datePublished": "2011-12-08 00:00:00 +0000",
        "dateModified": "2011-12-09 10:21:23 +0000",
        "isAccessibleForFree": "True",
        "author": {
            "@type": "Person",
            "name": "Lars Olesen",
            "description": "Familiefar. Højskolemenneske.",
            "sameAs": ["https://www.linkedin.com/in/lsolesen/","https://facebook.com/lsolesen","https://x.com/lsolesen","https://github.com/lsolesen","https://www.youtube.com/lsolesen","https://instagram.com/larssolesen","https://mastodon.social/@lsolesen","https://www.buymeacoffee.com/lsolesen"],
            "image": {
                "@type": "ImageObject",
                "url": "https://www.larsolesen.dk/assets/images/authors/lars-olesen.png"
            },
            "publishingPrinciples": "https://www.larsolesen.dk/om/"
        },
        "publisher": {
            "@type": "Organization",
            "name": "larsolesen.dk",
            "description": "larsolesen.dk.",
            "sameAs": "https://www.larsolesen.dk",
            "logo": {
                "@type": "ImageObject",
                "url": null
            },
            "publishingPrinciples": "https://www.larsolesen.dk/om/"
        }
    }
</script>









  <meta name="yandex-verification" content="5f0174c24bd690f2">






  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="larsolesen.dk Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993815627805299"
     crossorigin="anonymous"></script>




<link rel="manifest" type="application/manifest+json" href="/manifest.json">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<script>
// Check compatibility for the browser we're running this in
if ("serviceWorker" in navigator) {
  if (navigator.serviceWorker.controller) {
    console.log("[larsolesen.dk] active service worker found, no need to register");
  } else {
    // Register the service worker
    navigator.serviceWorker
      .register("/pwabuilder-sw.js", {
        scope: "./"
      })
      .then(function (reg) {
        console.log("[larsolesen.dk] Service worker has been registered for scope: " + reg.scope);
      });
  }
}
</script>

  </head>

  <body class="layout--single">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KGW3M5J"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <style>
      .progress { position: fixed; top: 0; left: 0; height: 5px; background-color: purple; transition: all linear 0.1s; }
    </style>
    <div class="progress"></div>
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Gå til hovedmenuen</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Gå til indholdet</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Gå til sidefoden</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          larsolesen.dk
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/foto/"
                
                
              >Foto</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Søgning til/fra</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Vis/skjul menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://www.larsolesen.dk/">
        <img src="/assets/images/authors/lars-olesen.png" alt="Lars Olesen" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.larsolesen.dk/" itemprop="url">Lars Olesen</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Familiefar. Højskolemenneske.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Følg</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Vejle</span>
        </li>
      

      
        
          
            <li><a href="mailto:lsolesen@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">E-mail</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/lsolesen/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
          
            <li><a href="https://facebook.com/lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://x.com/lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">Youtube</span></a></li>
          
        
          
            <li><a href="https://instagram.com/larssolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
          
            <li><a href="https://mastodon.social/@lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i><span class="label">Mastodon</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/lsolesen" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-mug-hot" aria-hidden="true"></i><span class="label">Køb mig en kaffe</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Struggling with duplicate content in Drupal 7">
    <meta itemprop="description" content="I struggled many hours to improve the technical side of SEO on Vejle Idrætshøjskoles website. Here is what I discovered:">
    <meta itemprop="datePublished" content="2011-12-08T00:00:00+00:00">
    <meta itemprop="dateModified" content="2011-12-09T10:21:23+00:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7" itemprop="url">Struggling with duplicate content in Drupal 7
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minutters læsning
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>I struggled many hours to improve the technical side of SEO on <a href="https://www.vih.dk">Vejle Idrætshøjskole</a>s website. Here is what I discovered:</p>

<h2 id="google-webmaster-tools-showed-me-duplicate-content">Google Webmaster Tools showed me duplicate content</h2>

<p>After reviewing Google Webmaster Tools (under Diagnose –&gt; HTML suggestions) I discovered that I had quite a lot of duplicate content, mainly caused by Views adding order- and sort-parameters to the query, thus making Google index basically the same page twice. Allthough, it seems that <a href="https://support.google.com/webmasters/bin/answer.py?hl=en&amp;answer=66359">Google doesn’t think webmasters should make special measures anymore</a>, I do not like having my pages indexed twice.</p>

<p>There is also a <a href="https://drupal.org/node/345620">discussion at drupal.org which addresses the problem about duplicate content</a>, as I discovered.</p>

<h2 id="blocking-duplicate-links-in-robotstxt">Blocking duplicate links in robots.txt</h2>

<p>To avoid the links introduced by views being indexed by Google, I entered the following in my robots.txt.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Disallow: /*sort=
Disallow: /*order=
Disallow: /*page=1
</code></pre></div></div>
<p>In a week or so, I hope that I will be rid of all the duplicate content created by the extra parameters views adds to the links.</p>

<h2 id="views-should-not-default-to-base-view">Views should not default to base view</h2>

<p>Having setup a Views page on e.g. example.com/nyheder will automatically make requests like example.com/nyheder/34 show the base view url. To avoid this, you need to setup contextual filters on your views. I just leave everything to the basic settings, except I will add a validation rule. If the validation does not pass, I will show a 404. That, I hope, basically solved my biggest problem with duplicate content. And hopefully whis will make Google very happy and will award me some SEO LOVE.</p>

<p>What are you doing to avoid duplicate content?</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Nøgleord: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#drupal" class="page__taxonomy-item p-category" rel="tag">drupal</a><span class="sep">, </span>
    
      <a href="/tags/#planet-drupal" class="page__taxonomy-item p-category" rel="tag">planet drupal</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Opdateret:</strong> <time class="dt-published" datetime="2011-12-09">December 9, 2011</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Del på</h4>
  

  <a href="https://twitter.com/intent/tweet?via=lsolesen&text=Struggling+with+duplicate+content+in+Drupal+7%20https%3A%2F%2Fwww.larsolesen.dk%2Fcontent%2Fstruggling-duplicate-content-drupal-7" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Del på Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.larsolesen.dk%2Fcontent%2Fstruggling-duplicate-content-drupal-7" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Del på Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.larsolesen.dk/content/struggling-duplicate-content-drupal-7" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Del på LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/node/336" class="pagination--pager" title="Creating an Drupal App Server
">Forrige</a>
    
    
      <a href="/node/339" class="pagination--pager" title="Adding small teaser slideshow
">Næste</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <script>function setText(elementId, textContent) {
		document.getElementById(elementId).textContent = textContent;
	};

	function show(elementId) {
		document.getElementById(elementId).style.display = 'inline';
	};

	function hide(elementId) {
		document.getElementById(elementId).style.display = 'none';
	};

	function getValue(elementId) {
		return document.getElementById(elementId).value;
	};

	function setValue(elementId, value) {
		return document.getElementById(elementId).value = value;
	};

	function fadeIn(element) {
		var duration = 400;
		element.style.opacity = 0;
		let opacity = 0;
		const timer = setInterval(function() {
		  opacity += 50 / duration;
		  if (opacity >= 1) {
		    clearInterval(timer);
		    opacity = 1;
		  }
		  element.style.opacity = opacity;
		}, 50);
	};


	function disableButtonWithLoader(elementId) {
		var buttonToDisable = document.getElementById(elementId);
		if (buttonToDisable == null) {
			return;
		}
		buttonToDisable.disabled = true;
		console.log('disable button with loader');
		setText(elementId, "Indlæser...");
	}

	function disablePostCommentButton() {
		disableButtonWithLoader("comment-form-submit");
	};

	function enablePostCommentButton() {
		var postCommentButton = document.getElementById("comment-form-submit");
		postCommentButton.disabled = false;
		setText("comment-form-submit", "Send kommentar");
	};async function initialCommentLoad() {
		console.log('initial comments load');
		disableButtonWithLoader("load-comment-button");

		var loadMD5 = document.createElement("script");
		loadMD5.src = "https://unpkg.com/pure-md5@latest/lib/index.js";
		document.head.appendChild(loadMD5);/* Load Recaptcha */
		var loadRecaptcha = document.createElement("script");
		loadRecaptcha.src = "https://www.google.com/recaptcha/enterprise.js?render=6LeRKAAjAAAAAD85dQDWplJEiT8JB2lzHkKfnUzA";
		document.head.appendChild(loadRecaptcha);/* Load Validator (to ensure we don't run code from comments for example) */
		var loadValidator = document.createElement("script");
		loadValidator.src = "https://cdnjs.cloudflare.com/ajax/libs/validator/13.7.0/validator.min.js";
		document.head.appendChild(loadValidator);

		/* Await Scripts Loaded */await loadRecaptcha.onload;await loadValidator.onload;

		reloadComments();
	};

	var thisPageUrl = "/content/struggling-duplicate-content-drupal-7";
	const EXTRA_INFO_START = "chunkedCommentInfoStart";
	const EXTRA_INFO_END = "chunkedCommentInfoEnd";var visibleComments = [];
	var hiddenComments = [];
	var netNewComments = [];var commentIds = new Set();/* Format the comment's date to our desired format */
	function formatDate(stringDate) {
		var date = new Date(stringDate);
		var dateOptions = { year: 'numeric', month: 'long', day: 'numeric'};
		var timeOptions = { hour: 'numeric', minute: 'numeric' };
		return `${date.toLocaleDateString("en-us", dateOptions)} at ${date.toLocaleTimeString("en-us", timeOptions)}`;
	};async function displayComments(comments) {
		console.log('displayComments()');
		show("comments-and-input");
		hide("load-comments");
		var hasVisibleComments = visibleComments.length > 0;

		/* if we have no comments, show the 'no comments available' section */
		if (comments == null || comments === "" || comments == []) {
			if (!hasVisibleComments) {
				show("no-comments");
				hide("load-more-comments");
				hide("num-comments-displayed");
			}
			return;
		}commentIds = new Set();var newHiddenComments = comments.map(item => {
				commentIds.add(Date.parse(item.timestamp)?.toString());
				return item;
			}).sort((a, b) => (new Date(a.timestamp).getTime() || 0) - (new Date(b.timestamp).getTime() || 0))
			.map(item => JSON.stringify(item));

		if (hasVisibleComments) {
			netNewComments = newHiddenComments
				.filter(item => !visibleComments.includes(item))
				.filter(item => !hiddenComments.includes(item));
		}

		hiddenComments = newHiddenComments
			.filter(item => !visibleComments.includes(item))
			.filter(item => !netNewComments.includes(item));

		loadMoreComments(false || !hasVisibleComments);
	};

	/* Loads more comments if there are any left to display from those already loaded from the server */
	function loadMoreComments(isLoadMoreAction) {
		console.log('loadMoreComments()');var newCommentsToDisplay = hiddenComments.slice(-5);if (isLoadMoreAction) {
			/* iterate over each comment that came from Google Sheets */
			newCommentsToDisplay.reverse().forEach(element => displaySingleComment(element, true));
			hiddenComments = hiddenComments.filter(item => !newCommentsToDisplay.includes(item) && !visibleComments.includes(item));
		} else {
			/* add the new comments if there are any */
			netNewComments.forEach(element => displaySingleComment(element, false));
			netNewComments = []
		}
		if (hiddenComments.length == 0) {
			setText("num-comments-displayed", `Showing ${visibleComments.length} of ${visibleComments.length + hiddenComments.length} comments`);
			hide("load-more-comments");
			hide("num-comments-displayed");
		} else {
			show("load-more-comments");
		}
	};var currentFadeItem = null;

	function fadeColor(element) {
		if (currentFadeItem != null) {
			clearInterval(currentFadeItem);
			currentFadeItem = null;
		}

		var duration = 1000;
		var step = 25;
		let opacity = 1;
		const timer = setInterval(function() {
		  opacity -= (1 / (duration / step));
		  if (opacity <= 0) {
		    clearInterval(timer);
		    currentFadeItem = null;
		    opacity = 0;
		  }
		  element.style.background = "rgba(3, 155, 229, "+ opacity +")";
		}, step);
		currentFadeItem = timer;
	};

	function smoothScrollTo(element) {
		element.scrollIntoView({
		  behavior: "smooth",
		  block: "start",
		  inline: "nearest"
		});
	};

	function jumpToComment(commentId) {
		var element = document.getElementsByClassName("" + commentId)[0];
		while(element == null && hiddenComments.length > 0) {
			loadMoreComments(true);
			element = document.getElementsByClassName("" + commentId)[0];
		}
		if (element != null) {
			smoothScrollTo(element);
			fadeColor(element);
		}
	};

	function clearCommentReplyItem() {
		document.getElementById("comment-reply-info").innerHTML = ``;
	};

	function replyToComment(commentId) {
		document.getElementById("comment-reply-info").innerHTML = `<small class="comment-reply-clear" onclick="clearCommentReplyItem()">Ⓧ&nbsp;&nbsp;&nbsp;</small><small onClick="jumpToComment('${commentId}')">Replying to comment <a id="reply-to-comment-id">${commentId}</a></small>`;
		smoothScrollTo(document.getElementById("comment-form"));
	};function getCommentInfo(comment) {
		var extraCommentInfo = comment?.match(EXTRA_INFO_START + ".+" + EXTRA_INFO_END);
		return {
			text : comment?.replace(extraCommentInfo, ""),
			extraCommentInfo : JSON.parse(extraCommentInfo?.toString()?.replace(EXTRA_INFO_START, "")?.replace(EXTRA_INFO_END, "") ?? "{}")
		};
	};

	function displaySingleComment(element, isPrepend) {
		console.log('displaySingleComment()');
		/* don't re-add existing comments */
		if (visibleComments.includes(element)) {
			return;
		}

		var jsonElement = JSON.parse(element);
		var comment = getCommentInfo(jsonElement.comment?.toString());

		/* If the author was the one who commented back, add this 'verified' logic */
		var verifiedAuthorTag = "";
		if (jsonElement.isAuthor == true || jsonElement.isAuthor === "TRUE") {
			verifiedAuthorTag = "&nbsp;<strong>(Author)</strong>";
		}
		/* Create the new item using HTML and append it to the user-visible comment section */
		var newItem = document.createElement("div");
		newItem.classList.add("comment-item");newItem.classList.add("reply-item");
		var commentReplyId = "" + Date.parse(jsonElement.timestamp);
		newItem.classList.add(commentReplyId);
		var replyToHtml = null;
		var replyId = comment?.extraCommentInfo?.replyToCommentId;
		if (replyId != null && replyId != "" && commentIds.has(replyId)) {
			replyToHtml = `<p class="comment-reply-id" onclick="jumpToComment('${replyId}')"><<< ${replyId}</p>`;
		}
		var currentCommentReplyButton = `<span class="comment-reply-button" onclick="replyToComment(${commentReplyId})"><img />Reply</span>`;
		var email = md5(validator.escape((jsonElement.email.trim()).toString()).toLowerCase());
		if (jsonElement.homepage.toString().trim() != "") {
			nameExtended = `<span itemprop="name"><a rel="external nofollow" itemprop="url" href="${validator.escape(jsonElement.homepage.toString())}">${validator.escape(jsonElement.name.toString())}${verifiedAuthorTag}</a></span>`;
		} else {
			nameExtended = `<span itemprop="name">${validator.escape(jsonElement.name.toString())}${verifiedAuthorTag}</span>`;
		}
		var date = new Date(jsonElement.timestamp);
		newItem.innerHTML = `
			<article id="comment${commentReplyId}" class="js-comment comment" itemprop="comment" itemscope itemtype="https://schema.org/Comment">
				<div class="comment__avatar-wrapper">
					<img class="comment__avatar" src="https://www.gravatar.com/avatar/${email}?d=mm&s=80" alt="${validator.escape(jsonElement.name.toString())}${verifiedAuthorTag}">
				</div>
				<div class="comment__content-wrapper">
					<p class="comment__author" itemprop="author" itemscope itemtype="https://schema.org/Person">
						${nameExtended ?? ""}
					</p>
					<p class="comment__date">
						<a href="#comment${commentReplyId}" itemprop="url">
							<time datetime="${date.toJSON()}" itemprop="datePublished">${formatDate(jsonElement.timestamp)}</time>
						</a>
					</p>
					${replyToHtml ?? ""}
					<div itemprop="text">${validator.escape(comment?.text?.toString()).replace(new RegExp('\r?\n','g'), '<br />')}</div>${currentCommentReplyButton ?? ""}</div>
			</article>
		`.trim();
		if (isPrepend) {
			document.getElementById("comment-container").prepend(newItem);
		} else {
			document.getElementById("comment-container").append(newItem);
		}
		fadeIn(newItem);
		visibleComments.push(element);

		/* Hide the 'no comments available' section since we have added a comment */
		hide("no-comments");
		show("num-comments-displayed");
	};

	function reloadComments() {
		console.log('reloadComments()');
		fetch(`https://script.google.com/macros/s/AKfycbzRevVoiMW67A11Bn6sRmm7la5Rhty5ROAJ_8510g-8QDc3YoSmxANrZy_Bmus3Nr8_/exec?url=${thisPageUrl}`)
		.then(response => response.json())
		.then(response => {
			var error = response?.error || null;
			if (error != null) {
				console.error(error);
				setText("comment-submit-error", error);
				show("comment-submit-error");
			} else {
				setText("comment-submit-error", '');
				hide("comment-submit-error");
				console.log('Ready to display comments');
				displayComments(response);
			}
		});
	};

	/* encodes the form data for http transport */
	const encodeFormData = (data) => {
	    return Object.keys(data)
	        .map(key => encodeURIComponent(key) + '=' + encodeURIComponent(data[key]))
	        .join('&');
	};function checkRecaptcha() {
		/* Disallow posting a new comment until this one has posted or failed. */
		disablePostCommentButton();

		grecaptcha.enterprise.ready(function() {
        	var pageAction = "comment_submit_Struggling with duplicate content in Drupal 7".replace(/[^A-Za-z/_]/g, "");

			grecaptcha.enterprise.execute('6LeRKAAjAAAAAD85dQDWplJEiT8JB2lzHkKfnUzA', {action: 'login'}).then(function(token) {
				postComment(token);
    		});
		});
        return false;
    };function getCommentContent() {
		var comment = getValue("comment-form-message")?.toString();

		var extraCommentInfo = {};var replyToCommentId = document?.getElementById("reply-to-comment-id")?.text;
		if (replyToCommentId != null && replyToCommentId != "") {
			extraCommentInfo.replyToCommentId = replyToCommentId;
		}if (Object.keys(extraCommentInfo).length !== 0) {
			comment = EXTRA_INFO_START + JSON.stringify(extraCommentInfo) + EXTRA_INFO_END + comment;
		}

		return comment;
	};

	/* Posts a comment */
	function postComment(recaptchaToken) {
		disablePostCommentButton();
		var username = getValue("comment-form-name");
		var email = getValue("comment-form-email");
		var homepage = getValue("comment-form-url");
		var comment = getCommentContent();

		fetch(`https://script.google.com/macros/s/AKfycbzRevVoiMW67A11Bn6sRmm7la5Rhty5ROAJ_8510g-8QDc3YoSmxANrZy_Bmus3Nr8_/exec`, {
		  method: 'POST',
		  mode: 'cors',
		  redirect: "follow",
		  headers: {
		    "Content-Type": "text/plain;charset=utf-8"
		  },
		  body: JSON.stringify({
		  	url : thisPageUrl?.toString(),
		  	name : username?.toString(),
		  	comment : comment?.toString(),
			email : email?.toString(),
			homepage : homepage?.toString(),
		  	recaptchaToken: (recaptchaToken || null)
		  })
		}).then(response => response.json())
		.then(response => {
			var error = response?.error || null;
			if (error != null) {
				console.error(error);
				setText("comment-submit-error", error);
				show("comment-submit-error");
			} else {
				setValue("comment-form-name", '');
				setValue("comment-form-email", '');
				setValue("comment-form-url", '');
				setValue("comment-form-message", '');
				setText("comment-submit-error", '');
				hide("comment-submit-error");
				displayComments(response);clearCommentReplyItem();console.log(response);
			}
		})
		.catch(error => {console.log(error);})
		.finally(() => { 
			enablePostCommentButton();
		});

		return false;
	};</script><div class="page__comments">
	<h4 class="page__comments-title">Kommentarer</h4>
	<div id="load-comments" class="comments">
		<button id="load-comment-button" class="btn btn--large btn--success" onclick="initialCommentLoad()">Load Comments <i class="far fa-comment-alt"></i></button>
	</div>
	<section id="comments-and-input">
		<div id="comment-section" class="comments">
		<p id="num-comments-displayed"></p>
		<button id="load-more-comments" class="btn btn--large btn--success" onclick="loadMoreComments(true)" type="button">Load Older Comments <i class="far fa-comment-alt"></i></button>
		<div id="no-comments" class="comment-info-text">
			<p>You can be the first to add a comment below.</p>
		</div>
		<div id="comment-container"></div>

		<div class="page__comments-form">
			<h4 class="page__comments-title">Leave a Comment</h4>
			<p class="small">Din e-mail bliver ikke offentliggjort. Obligatoriske felter er markeret Required fields are marked <span class="required">*</span>.</p><form id="comment-form" class="page__comments-form js-form form" onsubmit="return checkRecaptcha()" autocomplete="off"><div class="form__spinner">
				<i class="fas fa-spinner fa-spin fa-3x fa-fw"></i>
				<span class="sr-only">Indlæser...</span>
			</div>

			<div class="form-group">
				<label for="comment-form-message">Kommentar <small class="required">*</small></label>
				<textarea type="text" rows="3" id="comment-form-message" name="fields[message]" tabindex="1" required></textarea>
			</div>
			<div class="form-group">
				<label for="comment-form-name">Navn <small class="required">*</small></label>
				<input type="text" id="comment-form-name" name="fields[name]" tabindex="2" required /><div class="small help-block" id="comment-reply-info"></div></div>
			<div class="form-group">
				<label for="comment-form-email">E-mail <small class="required">*</small></label>
				<input type="email" id="comment-form-email" name="fields[email]" tabindex="3" />
				<div class="small help-block">Your email address will not be published.</div>
			</div>
			<div class="form-group">
				<label for="comment-form-url">Website (frivillig)</label>
				<input type="url" id="comment-form-url" name="fields[url]" tabindex="4"/>
			</div>
			<!-- Start comment form alert messaging -->
			<p class="hidden js-notice">
				<strong id="comment-submit-error" class="js-notice-text"></strong>
			</p>
			<!-- End comment form alert messaging -->
			<div class="form-group">
				<button type="submit" id="comment-form-submit" tabindex="5" class="btn btn--primary btn--large">Send kommentar</button>
			</div><p id="comment-recaptcha-disclaimer">
				This site is protected by reCAPTCHA and the Google
				<a href="https://policies.google.com/privacy">Privacy Policy</a> and
				<a href="https://policies.google.com/terms">Terms of Service</a> apply.
			</p></form>
		</div>
	</section>
</div><style>.comment-reply-button {
	float: right;
	cursor: pointer;
	font-size: 0.8em;
}

.comment-reply-button img {
	display: inline;
	vertical-align: middle;
	width: 1.2em;
	height: 1.2em;
	margin: 0;
	content:url("data:image/svg+xml,%3Csvg xmlns='https://www.w3.org/2000/svg' height='24px' viewBox='0 0 24 24' width='24px' fill='%23999999'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z'/%3E%3C/svg%3E");
}

.comment-reply-button:hover {
	color: #e91e63;
}

.comment-reply-button:hover img {
	content:url("data:image/svg+xml,%3Csvg xmlns='https://www.w3.org/2000/svg' height='24px' viewBox='0 0 24 24' width='24px' fill='%23e91e63'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z'/%3E%3C/svg%3E");
}

.comemnt-reply-id {
	color: #e91e63;
	font-size: .9em;
	cursor: pointer;
}

#comment-reply-info {
	float: right;
	font-size: .9em;
	color: #e91e63;
	cursor: pointer;
}

#comment-reply-info small {
	vertical-align: middle;
}

.comment-reply-clear {
	color: #e91e63;
	font-size: 1.1em;
	cursor: pointer;
}#load-more-comments {
	width: auto;
}

#load-more-comments,
#num-comments-displayed {
	display: none;
}.grecaptcha-badge {
	visibility: hidden;
}

#comment-recaptcha-disclaimer {
	text-align: justify;
    text-align-last: center;
    font-size: .7em;
	font-family: "Source Sans Pro", sans-serif;
}#comment-submit-error {
	color: red;
	display: none;
}

.comment-info-text {
	letter-spacing: 0.5px;
    text-align: center;
}

.comment-info-text p {
	margin: 0 0 1rem;
	text-align: justify;
    text-align-last: center;
    font-size: .9em;
}

#comment-container {
	width: 100%;
}

#comment-section, #load-comments {
	display: flex;
	flex-direction: column;
	justify-content: center;
}#comments-and-input {
	display: none;
}</style>
  
</div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">Måske kan du også lide</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/node/341" rel="permalink">In search for a better admin experience for Drupal 7 users
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minutters læsning
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I am working on a site for Vejle Idrætshøjskole in Drupal 7. The content editors are non tech, so I am trying to improve the admin backend, so the experience...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/node/339" rel="permalink">Adding small teaser slideshow
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minutters læsning
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">On Vejle Idrætshøjskoles website I wanted a small teaser slideshow with a picture, title and a link to the actual content. To accomplish that I used Views 3,...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/node/270" rel="permalink">vih.dk now in Drupal 7
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minutters læsning
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Previously vih.dk was programmed in a home grown CMS system. The system had some limitations regarding adding and editing new regular pages, so we needed a n...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/node/315" rel="permalink">Setting up a mediacenter with xbmc and mythtv on ubuntu natty (11.04)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minutters læsning
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Setting up a mediacenter in Ubuntu is not neccessarily a Plug’n’Play experience. You need to dig hard in Google to make everything work. Here are my notes fo...</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Hvad leder du efter...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Hvad leder du efter..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Følg:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/lsolesen" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://facebook.com/lsolesen" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/lsolesen/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
        
          <li><a href="https://instagram.com/larssolesen" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
        
          <li><a href="https://www.buymeacoffee.com/lsolesen" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-mug-hot" aria-hidden="true"></i> Køb mig en kaffe</a></li>
        
      
        
          <li><a href="https://github.com/lsolesen" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://www.larsolesen.dk">larsolesen.dk</a>. Drives af <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <!-- start custom comments scripts -->

<!-- end custom comments scripts -->





    <script>
      $(document).on("scroll", function(){
        var pixels = $(document).scrollTop();
        var pageHeight = $(document).height() - $(window).height();
        var progress = 100 * pixels / pageHeight;
        
        $("div.progress").css("width", progress + "%");
      });
      
    </script>
  </body>
</html>
